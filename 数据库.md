### 数据库表结构的设计：

找名词，将名词分为 实体和属性

每个实体一张表，每个属性一个字段

确定表与表的关系：

- 一对一： 将一张表的编号字段添加到另一张表中作为关键字段
- 一对多：将一的一端的编号添加到多的一端表中作为关联字段
- 多对多：新建一张关系表，它记录着两端的编号

 ER图 ---- 这是一个数据库表结构设计的辅助工具 矩形表示表，椭圆表示字段，菱形表示关系

员工关系系统需求：公司的每个部门中包含各自的员工，部门需要统计编号，名称所在地。员工需要统计编号，姓名

#### 范式：数据库表设计的规范

- 第一范式：列不可分
- 第二范式：要有主键，不存在部分依赖
- 第三范式：不存在传递依赖

## 2022/7/16

### sql

对数据库操作的标准语言

DDL ---- 数据定义语言：针对数据库对象进行操作的语言

DML ---- 数据操纵语言：针对数据进行操作的语言

创建一张表：

~~~~plsql
create table 表名(
    字段名1 类型,
    字段名2 类型,
    ...
)
~~~~

插入一条记录：

~~~plsql
insert into 表名(字段名1,字段名2,...)values('值1','值2',...)
-- 注意：values前面的小括号决定了要对那些字段插值，如果对所有的字段插值，则values前面的小括号可以省略不写
insert into cominfo0716
  (cno, cname, phone, address, email)
values
  ('1001', '张三', '123655', '江苏省', '12@qq.com');
~~~

查询记录：

~~~plsql
select 字段列表 from 表名  
-- 注意：* 表示所有字段
select * from COMINFO0716 t
~~~

删除记录：

~~~plsql
delete from 表名 where 条件
delete from cominfo0716 where cno = '1001';
~~~

删除表：

~~~plsql
drop table 表名
~~~

Oracle中的数据类型：

- `varchar(长度)` ---- 不定长的字符串
- `integer` ---- 整型
- `date` ---- 日期型
- `number(长度,小数位)` ---- 浮点型
- `to_date('日期字符串','日期格式')` ---- 将字符串转日期型，在日期格式中y表示年，m表示月，d表示日

~~~plsql
create table cominfo0716(
       cno varchar2(20),
       cname varchar2(20),
       phone varchar2(20),
       address varchar2(200),
       email varchar2(32),
       qq integer,
       birthday date,
       weight number(5,2)
);

insert into cominfo0716
values
  ('1003',
   '王五',
   '14343655',
   '江苏省',
   '12111@qq.com',
   '1208196222',
   to_date('1998-07-01', 'yyyy-mm-dd'),
   '70.75');
~~~

h表示小时

mi表示分钟

s表示秒

~~~plsql
insert into cominfo0716
values
  ('1005',
   '赵六',
   '14343655',
   '江苏省',
   '12111@qq.com',
   '1208196222',
   to_date('1998-07-01 20:03:08', 'yyyy-mm-dd hh24:mi:ss'),-- hh24表示24小时制 hh表示12小时制
   '117.714111');-- 超出精度的小数会自动四舍五入 超出精度的整数会报错
~~~

修改记录：

~~~plsql
update 表名 set 字段名1 = 新值,字段名2 = 新值2...
where 条件语句
~~~

约束：

限定表中的数据必须满足某种要求

- not null ---- 该字段值不能为空
- unique ---- 唯一约束，该字段值不能重复

~~~plsql
create table cominfo0716(
       cno varchar2(20) not null,-- 该字段值不能为空
       cname varchar2(20),
       phone varchar2(20) unique, -- 该字段值不能重复
       address varchar2(200),
       email varchar2(32),
       qq integer,
       birthday date,
       weight number(5,2)
);
~~~

~~~plsql
-- 注意：还可以使用constraint 自定义名字 unique() 表示该字段唯一
create table cominfo0716(
       cno varchar2(20) not null,
       cname varchar2(20),
       phone varchar2(20),
       address varchar2(200),
       email varchar2(32),
       qq integer,
       birthday date,
       weight number(5,2),
       constraint uk0716 unique(phone) -- 表示该字段唯一
);
~~~

- primary key ---- 主键约束，它包含了非空和唯一

  注意：还可以使用 constraint 自定义名字 primary key(字段)表示该字段为主键；

~~~plsql
create table cominfo0716(
       cno varchar2(20) primary key,
       cname varchar2(20),
       phone varchar2(20),
       address varchar2(200),
       email varchar2(32),
       qq integer,
       birthday date,
       weight number(5,2),
       constraint uk0716 unique(phone)
);


create table cominfo0716(
       cno varchar2(20),
       cname varchar2(20),
       phone varchar2(20),
       address varchar2(200),
       email varchar2(32),
       qq integer,
       birthday date,
       weight number(5,2),
       constraint uk0716 unique(phone),
       constraint uk0716 primary key(cno)-- 小括号里如果是多个字段则为联合主键
);
~~~

- 外键约束 ---- 将被关联表的主键字段添加到当前表中当作外键，两层约束：

  1. 当插入从表中的数据时，其外键值必须存在于主表中
  2. 当删除主表中的数据时，其主键值必须没有被从表关联

  语法：在外键字段后添加 references 主表名(主表主键名)

~~~plsql
create table class0716(
cno varchar2(32) primary key,
cname varchar2(32)
);

create  table student0716(
sno varchar2(32) primary key,
sname varchar2(32),
sage integer,
cno varchar2(32) references class0716(cno)
);
~~~

~~~plsql
-- 注意：也可以使用constraint 自定义名称 foreign key(字段名) references 主表名(主表主键名) 来创建外键
create  table student0716(
sno varchar2(32) primary key,
sname varchar2(32),
sage integer,
cno varchar2(32),
constraint fk0716 foreign key(cno) references class0716(cno)
);
~~~









