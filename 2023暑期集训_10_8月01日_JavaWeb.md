# 2023年8月1日

## Tomcat

1. 这是一个流行的web容器，用来部署发布网站的工具，它需要运行在Java环境的服务器上
2. 修改Tomcat端口：配置根目录/conf/server.xml中的`<connector>`中的port属性

## URL地址结构

`http://ip地址:端口号/web应用的名称/请求名`

~~~
http://ip地址:端口号/web应用的名称/请求名
|__________________|		   |
     web站点根目录               |
|_______________________________|
		web应用的根目录
~~~

web站点根目录：`http://ip地址:端口号`

web应用的根目录：`web站点的根目录/web应用的名字`

完整的URL：`web应用的根目录/请求名`

**注意**：请求名对应web.xml中的`<url-pattern>`

## servlet

狭义上：Servlet是一个接口，他可以接收请求返回响应，广义上讲，servlet是一个实现了Servlet接口的实现类，它重写了接口中的抽象方法，包括生命周期相关的方法：

生命周期方法：

调用构造方法实例化 ---- 只有一个实例化的Servlet对象

init() ---- 初始化方法

service() ---- 接收到一个请求，并返回响应

destroy() ---- 销毁当前servlet对象

**注意**：init方法只会执行一次，而service方法在每次请求到来的时候都被执行一次，destroy方法在tomcat停止的时候被执行一次

~~~
//ChatGPT:
Java Servlet的生命周期由Servlet容器管理，它在Servlet的整个生命周期中调用不同的方法。以下是Servlet生命周期的主要阶段和相应的方法：

1. 加载和实例化阶段：
   - 当Servlet容器启动时，它会查找并加载Web应用程序中的Servlet类。
   - 然后，Servlet容器通过调用Servlet类的构造函数来实例化Servlet对象。
   - 只会在Servlet容器启动时加载一次，并在后续请求中共享同一个Servlet实例。

2. 初始化阶段：
   - 实例化后，Servlet容器会调用Servlet的init()方法进行初始化。
   - 在init()方法中，可以执行一些初始化任务，比如读取配置信息、建立数据库连接等。
   - 每个Servlet实例只会初始化一次。

3. 请求处理阶段：
   - 一旦Servlet初始化完成，它就可以处理客户端发来的请求了。
   - 当有新的请求到达时，Servlet容器会在单独的线程中调用Servlet的service()方法。
   - service()方法根据请求的类型（GET、POST等）调用doGet()、doPost()等具体的处理方法。

4. 销毁阶段：
   - 当Servlet容器关闭时，或者Web应用程序被卸载时，Servlet容器会调用Servlet的destroy()方法。
   - 在destroy()方法中，可以执行一些资源释放的操作，比如关闭数据库连接、保存状态等。

值得注意的是，当Servlet容器检测到Servlet类的代码或配置文件发生改变时，它会自动重新加载和实例化Servlet，然后再次调用init()方法进行初始化。因此，在Web应用程序运行过程中，Servlet可能会多次初始化和销毁。

Servlet生命周期的管理使得Servlet容器可以高效地管理资源，并在需要时重新加载和更新Servlet，从而实现Web应用程序的动态性和灵活性。
~~~



## web.xml

这是web项目中的核心配置文件，它配置了各个请求对应的servlet类

格式：

~~~xml
<servlet>标签子标签
<servlet-name> ---- 当前servlet名字
<servlet-class> ---- 当前servlet类的全类名
<servlet-mapping> ---- 表示一个servlet的映射信息，包含两个子标签：
<servlet-name> ---- 当前servlet名字
<url-pattern> ---- 表示当前请求名   
~~~

~~~xml
    <servlet>
        <servlet-name>hello</servlet-name>
        <servlet-class>com.iweb.test.HelloServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>hello</servlet-name>
        <url-pattern>/myfirstrequest</url-pattern>
    </servlet-mapping>
~~~

**注意**：一个`<servlet>`可以对应多个`<servlet-mapping>`，由此，多个请求名都会进入该servlet类

~~~xml
    <servlet>
        <servlet-name>second</servlet-name>
        <servlet-class>com.iweb.test.MySecondServlet</servlet-class>
        <load-on-startup>0</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>second</servlet-name>
        <url-pattern>/second</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>second</servlet-name>
        <url-pattern>/second02</url-pattern>
    </servlet-mapping>
~~~



## `<load-on-startup>`

配置在`<servlet>`中，表示当前servlet被初始化的时机，如果配置非负整数，则表示tomcat启动进行初始化

~~~xml
<load-on-startup>0</load-on-startup>
~~~

多个servlet的加载顺序是按照`<load-on-startup>`值从小到大进行加载，0最先被加载，数字越大越靠后

## 通配符

`<url-pattern>`中的通配符

1. `/*` ---- 任意请求都能进这个servlet（除非有其他明确指定的）
2. `/` ---- 功能大致类似`/*`
3. `*.do` ---- do为自定义后缀，可以更改

~~~xml
ChatGPT:
/*：匹配所有URL。
/test/*：匹配所有以/test/开头的URL，如/test/foo和/test/bar。
/test/abc：仅匹配/test/abc这个具体的URL。
*.html：匹配所有以.html结尾的URL，如/page.html和/docs/index.html。
/user/*/profile：匹配类似/user/123/profile和/user/john/profile的URL
~~~

## 2023年8月2日

## ServletConfig

这是当前Servlet大管家，他可以获取当前servlet中方方面面的信息

getInitParameter() ---- 获取当前servlet的初始化参数

**注意**：初始化参数使用`<init-param>`配置在`web.xml`的`<servlet>`中

~~~xml
    <servlet>
        <servlet-name>second</servlet-name>
        <servlet-class>com.iweb.test.MySecondServlet</servlet-class>
        <init-param>
            <param-name>username</param-name>
            <param-value>root</param-value>
        </init-param>
        <load-on-startup>0</load-on-startup>
    </servlet>
~~~

~~~java
    @Override
    public void init(ServletConfig servletConfig) throws ServletException {
        System.out.println("当前servlet被初始化了");
        String username = servletConfig.getInitParameter("username");
        System.out.println(username);//打印root
    }
~~~

getServletName(); ---- 获取当前servlet的名字

## ServletContext

这是当前Web应用的大管家，它可以获取当前整个Web应用方方面面的信息

我们可以通过Servlet对象调用getServletContext()来获取ServletContext对象

ServletContext常用方法 ：

getInitParameter(参数名) ---- 获取当前web应用的初始化参数的参数值

注意：web应用的初始化参数配在`<servlet>`外，使用`<context-param>`标签来配置

~~~xml
    <context-param>
        <param-name>password</param-name>
        <param-value>123456</param-value>
    </context-param>
~~~

~~~java
        ServletContext servletContext = servletConfig.getServletContext();
        String password = servletContext.getInitParameter("password");
        System.out.println(password);//打印123456
~~~

getRealPath(文件在项目中的位置) ---- 获取指定文件在部署发布后的绝对路径

getContextPath() ---- 获取当前web应用的根目录

## ServletRequest

表示当前请求

getParameter(参数名) ----- 根据参数名得到对应的参数值

## 前端向servlet发起请求的方式

1. url地址栏写url，按回车键
2. `<a>`通过href属性配置url-pattern
3. `<form>`通过action属性配置url-pattern
4. ajax

## 关于传参

url地址栏可以使用`？`带参数，参数之间使用&符号分割

`<a>`可以使用href带参数

`<form>`可以使用name属性对应参数名，value属性对应参数值

## servlet项目中get和post请求方式区别

url地址栏发请求一定是get请求

 `<a>`发请求一定是get请求

`<form>`默认是get请求，method属性设置为post则为post请求

区别：

1. get请求的参数会显示在地址栏，post参数隐藏在消息体中
2. get请求参数长度不能超过1k，post没有长度限制

## ServletResponse

表示servlet返回的响应，我们可以调用该对象的getWriter()得到一个PrintWriter对象，再由PrintWriter对象调用print方法，完成返回内容的打印
