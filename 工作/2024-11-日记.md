

11月任务

使用session实现超时登出

使用脚本扫出api对应的角色id，然后用拦截器进行垂直鉴权

海南密码改造-实现短信登录功能





## 使用OkHttp时 `response.body().string()` 时，不能直接使用 `String` 参数接收

在使用 `response.body().string()` 时，不能直接使用 `String` 参数接收其内容的原因是 `response.body().string()` 返回的是一个 **一次性** 的字符串，而不是一个可重复读取的流或对象。调用 `string()` 方法会消耗掉响应体的内容，因此，一旦读取了响应体的内容，它将不再可用。

下面是具体的解释和相关的例子：

### 为什么 `response.body().string()` 不能重复读取
`response.body()` 返回的是一个 `ResponseBody` 对象，`ResponseBody` 是基于流的，它包含了从网络中读取的响应体数据。调用 `response.body().string()` 方法时，实际上会读取流中的数据并将其内容存储为字符串，并且**关闭**了流。因此，**如果你调用了 `string()` 方法，流会被消耗掉，之后不能再次读取**。

### 解决方法
为了避免流被消耗掉并且能够反复读取，可以通过以下两种方式：

#### 1. 使用 `response.body().bytes()` 获取字节数组
如果你需要在多次使用响应体的内容，可以先使用 `response.body().bytes()` 获取字节数组，然后将其转换为字符串。字节数组是一次性读取的，但它不会消耗流，因此你可以根据需要反复使用它。

```java
byte[] responseBytes = response.body().bytes();
String responseBody = new String(responseBytes, StandardCharsets.UTF_8);
```

#### 2. 缓存响应体
如果你希望能够多次访问响应体内容，可以将响应体的内容缓存到内存中，并在需要时进行操作。

```java
String responseBody = response.body().string();
```

然后，你可以在后续代码中使用 `responseBody` 变量来访问响应内容。

### 使用例子
假设你在用 OkHttp 进行 HTTP 请求时：

```java
import okhttp3.OkHttpClient;
import okhttp3.Request;
import okhttp3.Response;

import java.io.IOException;

public class Main {
    public static void main(String[] args) throws IOException {
        OkHttpClient client = new OkHttpClient();

        Request request = new Request.Builder()
                .url("https://jsonplaceholder.typicode.com/todos/1")
                .build();

        try (Response response = client.newCall(request).execute()) {
            // 读取响应体内容为字符串
            String responseBody = response.body().string();
            System.out.println(responseBody);
            
            // 之后再尝试读取响应体内容时，会抛出 IllegalStateException
            // System.out.println(response.body().string()); // 会抛出异常
        }
    }
}
```

在这个例子中，调用 `response.body().string()` 之后，流会被关闭，并且你不能再次读取 `response.body()`。如果需要多次使用响应体内容，应该将内容保存到变量中。

### 总结
- **`response.body().string()`** 方法会消耗流，读取一次后不能再读取流。
- 如果你需要多次访问响应体内容，应该将内容保存为一个变量（如 `String`）。
- 如果你想避免一次性读取，可以先用 `bytes()` 方法获取字节数组，或者使用缓存的方式保存响应体内容。





### 127.0.0.1和localhost和本机IP三者的区别

https://blog.csdn.net/bandaoyu/article/details/87259631