# 2023年8月14日

## Listener ---- 监听器

监听着我们web项目中的域对象什么时候被创建，什么时候被销毁

我们通常所说的监听器，指的是实现了监听器接口的实现类，该实现类需要在web.xml中配置`<listener>`标签，该标签包含`<listener-class>`指向当前监听器类。

1、ServletContextListener： 它监听着ServletContext对象什么时候被创建，什么时候被销毁，当它被创建的时候，会自动执行contextInitialized方法，当他被销毁的时候，会自动执行contextDestroyed方法

web.xml:

~~~xml
    <listener>
        <listener-class>com.iweb.test.HelloListener</listener-class>
    </listener>
~~~

HelloListener.java:

~~~java
package com.iweb.test;

import javax.servlet.ServletContextEvent;
import javax.servlet.ServletContextListener;

public class HelloListener implements ServletContextListener {
    @Override
    public void contextInitialized(ServletContextEvent servletContextEvent) {
        System.out.println("ServletContext对象被创建了");
    }

    @Override
    public void contextDestroyed(ServletContextEvent servletContextEvent) {
        System.out.println("ServletContext对象被销毁了");

    }
}
~~~

2、HttpSessionListener:它监听着一个会话什么时候创建，什么时候销毁
当它创建的时候调用sessionCreated方法
当它销毁的时候，调用sessionDestroyed方法

~~~java
package com.iweb.test;

import javax.servlet.ServletContextEvent;
import javax.servlet.ServletContextListener;
import javax.servlet.http.HttpSessionEvent;
import javax.servlet.http.HttpSessionListener;

public class HelloListener implements ServletContextListener, HttpSessionListener {
    @Override
    public void contextInitialized(ServletContextEvent servletContextEvent) {
        System.out.println("ServletContext对象被创建了");
    }

    @Override
    public void contextDestroyed(ServletContextEvent servletContextEvent) {
        System.out.println("ServletContext对象被销毁了");

    }

    @Override
    public void sessionCreated(HttpSessionEvent httpSessionEvent) {
        System.out.println("一个会话创建了");
    }

    @Override
    public void sessionDestroyed(HttpSessionEvent httpSessionEvent) {
        System.out.println("一个会话销毁了");
    }
}
 
~~~

**注意**：当关闭浏览器的时候，仅仅是当前会话不再可以被使用，而没有立即销毁，当调用invalidate方法时，会话立即销毁

~~~jsp
<%
    session.invalidate();
%>
~~~

3、ServletRequestListener:他监听着一个请求什么时候被创建，什么时候倍销毁

requestInitialized() ---- 一个请求倍创建时自动调用该方法

requestDestroyed() ---- 一个请求被销毁自动调用该方法

~~~java
public class HelloListener implements ServletContextListener, HttpSessionListener, ServletRequestListener {
    @Override
    public void contextInitialized(ServletContextEvent servletContextEvent) {
        System.out.println("ServletContext对象被创建了");
    }

    @Override
    public void contextDestroyed(ServletContextEvent servletContextEvent) {
        System.out.println("ServletContext对象被销毁了");

    }

    @Override
    public void sessionCreated(HttpSessionEvent httpSessionEvent) {
        System.out.println("一个会话创建了");
    }

    @Override
    public void sessionDestroyed(HttpSessionEvent httpSessionEvent) {
        System.out.println("一个会话销毁了");
    }

    @Override
    public void requestDestroyed(ServletRequestEvent servletRequestEvent) {
        System.out.println("一个请求被创建了");
    }

    @Override
    public void requestInitialized(ServletRequestEvent servletRequestEvent) {
        System.out.println("一个请求被销毁了");
    }
}

~~~

